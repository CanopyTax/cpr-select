/*!
 * cpr-select
 * author: Bret Little
 * copyright: 2015
 * license: MIT
 * version: 1.2.2
 */
!function(e){function t(s){if(n[s])return n[s].exports;var i=n[s]={exports:{},id:s,loaded:!1};return e[s].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function s(e,t){for(var n,s=!0;s;){s=!1;var i=e,o=t;if(!i)return!1;if(n=i.className.indexOf(o)>-1)return n;e=i.parentElement,t=o,s=!0}}var i=function(e){return e&&e.__esModule?e["default"]:e},o=i(n(1)),l=n(2).findIndex,a=void 0,c=void 0,r=o.createClass({displayName:"CanopySelect",componentWillMount:function(){document.body.addEventListener("click",this.state.close)},componentWillUnmount:function(){document.body.removeEventListener("click",this.state.close)},getInitialState:function(){var e=this,t=null;return this.props.selected&&(t=this.getIndex(this.props.selected)),{dialogDisplayed:!1,top:0,focused:!1,close:function(t){s(t.target,"cp-select-outer")||e.setState({dialogDisplayed:!1,focused:!1})}}},displayDialog:function(e){this.setState({dialogDisplayed:!0})},getIndex:function(e){return l(this.props.options,{key:e})},onKeyDown:function(e){var t=e.which,n=this.state.selectedIndex;9!==t&&e.preventDefault(),13===t?this.selectItem(n):38===t?this.setState({dialogDisplayed:!0,selectedIndex:void 0===n?0:n-1}):40===t?n===this.props.options.length-1?this.setState({dialogDisplayed:!0}):this.setState({dialogDisplayed:!0,selectedIndex:n?n+1:0}):27===t?this.setState({dialogDisplayed:!1}):this.highlightByText(e.which)},triggerItemChange:function(){this.props.onChange&&this.props.onChange.call(null,null!==this.state.selectedIndex?this.props.options[this.state.selectedIndex].key:null,this.props.options[this.state.selectedIndex],this.state.selectedIndex)},selectItem:function(e,t){var n=this;setTimeout(function(){n.setState({selectedIndex:e,focused:!0,dialogDisplayed:!1}),setTimeout(n.triggerItemChange)})},positionDialogAndGetTop:function(e,t){var n=e.length-t;return t>5&&6>n?e.length<11?-2+(36*t*-1-10)+"px":(this.positionDialog(t),-215-36*(5-n)+"px"):t>5?(this.positionDialog(t),"-203px"):-1+(36*t*-1-10)+"px"},positionDialog:function(e){var t=this;setTimeout(function(){var n=t.el.querySelector(".cp-select__menu");n&&(n.scrollTop=36*e-192)})},focusSelect:function(){this.state.focused||this.setState({focused:!0})},onBlur:function(){this.setState({focused:!1})},highlightByText:function(e){a+=String.fromCharCode(e);var t=this.getIndexFromString(a);t>-1&&this.setState({selectedIndex:t}),c=setTimeout(function(){a=""},1e3)},getIndexFromString:function(e){var t=this;return e=e.toLowerCase(),l(this.props.options,function(n){return 0===t.getViewValue(n).toLowerCase().indexOf(e)})},getViewValue:function(e){return e.value||e},getDialog:function(e,t){var n=this;if(e){var s=function(){var e=n.state.selectedIndex,s=[o.createElement("li",{key:"blankOption",className:null===e?"+selected":"",onMouseDown:n.selectItem.bind(n,null)},o.createElement("a",{style:{color:"rgba(0,0,0,0)"}},"null"))],i=s.concat(t.map(function(t,s){return o.createElement("li",{key:t.key,className:e===s?"+selected":"",onMouseDown:n.selectItem.bind(n,s)},o.createElement("a",null,t.value))}));return setTimeout(function(){try{n.el.querySelector(".cp-select__hidden-input").focus()}catch(e){if(-1===e.message.indexOf("Invariant Violation"))throw new Error(e.message)}},100),{v:o.createElement("div",null,o.createElement("ul",{className:"cp-select__menu cps-dropdown-menu",style:{top:n.positionDialogAndGetTop(t,null===e?0:e+1)}},i))}}();if("object"==typeof s)return s.v}},render:function(){var e="cp-select",t=this.props.options[this.getIndex(this.props.selected)],n=this;return this.props.disabled&&(e+=" +disabled"),this.state.focused&&(e+=" +focus"),o.createElement("div",{ref:function(e){e&&(n.el=e)},className:"cp-select-outer",role:"select"},o.createElement("input",{className:"cp-select__hidden-input",onFocus:this.focusSelect,onBlur:this.onBlur,onKeyDown:this.onKeyDown}),o.createElement("div",{className:e,onClick:this.displayDialog},o.createElement("div",{className:"cp-select__selected"},t?t.value:this.props.placeholder),o.createElement("div",{className:"cp-select__icon"})),this.getDialog(this.state.dialogDisplayed,this.props.options))}});window&&!window.CanopySelect&&(window.CanopySelect=r),e.exports=r},function(e,t){e.exports=React},function(e,t){e.exports=_}]);